{"ast":null,"code":"import _asyncToGenerator from \"C:\\\\Users\\\\R9\\\\Desktop\\\\AnyBuyStoreAngularUi\\\\AnyBuyStoreUi\\\\AnyBuyStoreUi\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { CartModel } from '../shared/models/cart-model.model';\nimport { OrderDetailsModel } from '../shared/models/order-details-model';\nimport { OrderModel } from '../shared/models/order-model';\nlet CartComponent = class CartComponent {\n  constructor(CartService, OrderDetailsService, OrderService, ProductService, router) {\n    this.CartService = CartService;\n    this.OrderDetailsService = OrderDetailsService;\n    this.OrderService = OrderService;\n    this.ProductService = ProductService;\n    this.router = router;\n    this.cartProducts = [];\n    this.OrderDetailsList = [];\n    this.orderId = 0;\n    this.addressId = 0;\n    this.userId = Number(localStorage.getItem('userId')) ? Number(localStorage.getItem('userId')) : 0;\n  }\n\n  getAddressIdFromChild(addressId) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      _this.addressId = addressId;\n    })();\n  }\n\n  createOrder() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      var order = new InOrderModel();\n      order.In.userId = Number(localStorage.getItem(\"userId\"));\n      order.In.addressId = _this2.addressId;\n\n      _this2.OrderService.add(order).subscribe( /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* (res) {\n          _this2.orderId = res;\n          yield _this2.addOrderDetailsToOrder(_this2.orderId);\n\n          _this2.router.navigate(['/order/' + _this2.orderId]);\n        });\n\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n\n  getAllCartProducts() {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this3.CartService.getAllByUserId(_this3.userId).subscribe( /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator(function* (res) {\n          _this3.cartList = res;\n        });\n\n        return function (_x2) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n    })();\n  }\n\n  addItem(newItem) {\n    console.log(newItem);\n    this.cartProducts.push(newItem);\n  }\n\n  onClickOrderPlace() {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      let orderId = _this4.createOrder();\n    })();\n  }\n\n  onClickDisplayAddressPanel() {\n    var _this5 = this;\n\n    return _asyncToGenerator(function* () {\n      var _a;\n\n      if (((_a = _this5.cartList) === null || _a === void 0 ? void 0 : _a.length) != 0) {\n        document.getElementById(\"editAddressPanel\").style.display = \"block\";\n\n        for (let cartItem of _this5.cartList) {\n          var cartDetails = new InCartModel();\n          cartDetails.In.id = cartItem.id;\n          cartDetails.In.quantity = Math.min(cartItem.quantity, cartItem.actualProductQuantity);\n          cartDetails.In.userId = Number(localStorage.getItem('userId'));\n          cartDetails.In.productId = cartItem.productId;\n          cartDetails.In.isAvailable = true;\n\n          _this5.CartService.update(cartDetails).subscribe({\n            next: _ => {\n              console.log(\"updated success\");\n            },\n            error: err => {\n              console.log(\"error\");\n            }\n          });\n        }\n      }\n    })();\n  }\n\n  addOrderDetailsToOrder(orderId) {\n    var _this6 = this;\n\n    return _asyncToGenerator(function* () {\n      for (let cartItem of _this6.cartList) {\n        var orderDetails = new InOrderDetailsModel();\n        orderDetails.In.orderId = orderId;\n        orderDetails.In.productId = cartItem.productId;\n        orderDetails.In.status = 'preparing';\n        orderDetails.In.quantity = cartItem.quantity;\n\n        _this6.ProductService.getById(cartItem.productId).subscribe(res => {\n          if (res.discountId) {\n            orderDetails.In.discountId = res.discountId;\n          }\n\n          _this6.OrderDetailsService.add(orderDetails).subscribe({\n            next: res => {\n              console.log(\"added success\");\n            },\n            error: err => {\n              console.log(\"error\");\n            }\n          });\n        });\n      }\n    })();\n  }\n\n  ngOnInit() {\n    var _this7 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this7.getAllCartProducts();\n    })();\n  }\n\n};\nCartComponent = __decorate([Component({\n  selector: 'app-cart',\n  templateUrl: './cart.component.html',\n  styleUrls: ['./cart.component.css']\n})], CartComponent);\nexport { CartComponent };\n\nclass InOrderModel {\n  constructor() {\n    this.In = new OrderModel();\n  }\n\n}\n\nclass InOrderDetailsModel {\n  constructor() {\n    this.In = new OrderDetailsModel();\n  }\n\n}\n\nclass InCartModel {\n  constructor() {\n    this.In = new CartModel();\n  }\n\n}","map":{"version":3,"sources":["C:/Users/R9/Desktop/AnyBuyStoreAngularUi/AnyBuyStoreUi/AnyBuyStoreUi/src/app/cart/cart.component.ts"],"names":["__decorate","Component","CartModel","OrderDetailsModel","OrderModel","CartComponent","constructor","CartService","OrderDetailsService","OrderService","ProductService","router","cartProducts","OrderDetailsList","orderId","addressId","userId","Number","localStorage","getItem","getAddressIdFromChild","createOrder","order","InOrderModel","In","add","subscribe","res","addOrderDetailsToOrder","navigate","getAllCartProducts","getAllByUserId","cartList","addItem","newItem","console","log","push","onClickOrderPlace","onClickDisplayAddressPanel","_a","length","document","getElementById","style","display","cartItem","cartDetails","InCartModel","id","quantity","Math","min","actualProductQuantity","productId","isAvailable","update","next","_","error","err","orderDetails","InOrderDetailsModel","status","getById","discountId","ngOnInit","selector","templateUrl","styleUrls"],"mappings":"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","sourcesContent":["import { __decorate } from \"tslib\";\r\nimport { Component } from '@angular/core';\r\nimport { CartModel } from '../shared/models/cart-model.model';\r\nimport { OrderDetailsModel } from '../shared/models/order-details-model';\r\nimport { OrderModel } from '../shared/models/order-model';\r\nlet CartComponent = class CartComponent {\r\n    constructor(CartService, OrderDetailsService, OrderService, ProductService, router) {\r\n        this.CartService = CartService;\r\n        this.OrderDetailsService = OrderDetailsService;\r\n        this.OrderService = OrderService;\r\n        this.ProductService = ProductService;\r\n        this.router = router;\r\n        this.cartProducts = [];\r\n        this.OrderDetailsList = [];\r\n        this.orderId = 0;\r\n        this.addressId = 0;\r\n        this.userId = Number(localStorage.getItem('userId')) ? Number(localStorage.getItem('userId')) : 0;\r\n    }\r\n    async getAddressIdFromChild(addressId) {\r\n        this.addressId = addressId;\r\n    }\r\n    async createOrder() {\r\n        var order = new InOrderModel();\r\n        order.In.userId = Number(localStorage.getItem(\"userId\"));\r\n        order.In.addressId = this.addressId;\r\n        this.OrderService.add(order).subscribe(async (res) => {\r\n            this.orderId = res;\r\n            await this.addOrderDetailsToOrder(this.orderId);\r\n            this.router.navigate(['/order/' + this.orderId]);\r\n        });\r\n    }\r\n    async getAllCartProducts() {\r\n        await this.CartService.getAllByUserId(this.userId).subscribe(async (res) => {\r\n            this.cartList = res;\r\n        });\r\n    }\r\n    addItem(newItem) {\r\n        console.log(newItem);\r\n        this.cartProducts.push(newItem);\r\n    }\r\n    async onClickOrderPlace() {\r\n        let orderId = this.createOrder();\r\n    }\r\n    async onClickDisplayAddressPanel() {\r\n        var _a;\r\n        if (((_a = this.cartList) === null || _a === void 0 ? void 0 : _a.length) != 0) {\r\n            document.getElementById(\"editAddressPanel\").style.display = \"block\";\r\n            for (let cartItem of this.cartList) {\r\n                var cartDetails = new InCartModel();\r\n                cartDetails.In.id = cartItem.id;\r\n                cartDetails.In.quantity = Math.min(cartItem.quantity, cartItem.actualProductQuantity);\r\n                cartDetails.In.userId = Number(localStorage.getItem('userId'));\r\n                cartDetails.In.productId = cartItem.productId;\r\n                cartDetails.In.isAvailable = true;\r\n                this.CartService.update(cartDetails).subscribe({\r\n                    next: (_) => {\r\n                        console.log(\"updated success\");\r\n                    },\r\n                    error: (err) => {\r\n                        console.log(\"error\");\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n    async addOrderDetailsToOrder(orderId) {\r\n        for (let cartItem of this.cartList) {\r\n            var orderDetails = new InOrderDetailsModel();\r\n            orderDetails.In.orderId = orderId;\r\n            orderDetails.In.productId = cartItem.productId;\r\n            orderDetails.In.status = 'preparing';\r\n            orderDetails.In.quantity = cartItem.quantity;\r\n            this.ProductService.getById(cartItem.productId).subscribe(res => {\r\n                if (res.discountId) {\r\n                    orderDetails.In.discountId = res.discountId;\r\n                }\r\n                this.OrderDetailsService.add(orderDetails).subscribe({\r\n                    next: (res) => {\r\n                        console.log(\"added success\");\r\n                    },\r\n                    error: (err) => {\r\n                        console.log(\"error\");\r\n                    }\r\n                });\r\n            });\r\n        }\r\n    }\r\n    async ngOnInit() {\r\n        await this.getAllCartProducts();\r\n    }\r\n};\r\nCartComponent = __decorate([\r\n    Component({\r\n        selector: 'app-cart',\r\n        templateUrl: './cart.component.html',\r\n        styleUrls: ['./cart.component.css']\r\n    })\r\n], CartComponent);\r\nexport { CartComponent };\r\nclass InOrderModel {\r\n    constructor() {\r\n        this.In = new OrderModel();\r\n    }\r\n}\r\nclass InOrderDetailsModel {\r\n    constructor() {\r\n        this.In = new OrderDetailsModel();\r\n    }\r\n}\r\nclass InCartModel {\r\n    constructor() {\r\n        this.In = new CartModel();\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}